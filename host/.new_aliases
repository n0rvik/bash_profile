# .bash_aliases

# interactive shell - OK
case $- in
    *i*) ;;
      *) return;;
esac

export TERM=xterm-256color
export CLICOLOR=1

shopt -s cmdhist
shopt -s histappend
shopt -s cdspell
shopt -s checkwinsize
shopt -s extglob
shopt -s globstar
shopt -s direxpand
shopt -s dirspell

export HISTCONTROL=ignorespace:ignoredups
export HISTSIZE=100000
export HISTFILESIZ=100000

export LESS=-R
export LESS_TERMCAP_mb=$'\E[1;31m'     # begin bold
export LESS_TERMCAP_md=$'\E[1;36m'     # begin blink
export LESS_TERMCAP_me=$'\E[0m'        # reset bold/blink
export LESS_TERMCAP_so=$'\E[01;44;33m' # begin reverse video
export LESS_TERMCAP_se=$'\E[0m'        # reset reverse video
export LESS_TERMCAP_us=$'\E[1;32m'     # begin underline
export LESS_TERMCAP_ue=$'\E[0m'        # reset underline
export GROFF_NO_SGR=1                  # for konsole and gnome-terminal

export GCC_COLORS='error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01'

bind 'set show-all-if-ambiguous On'
bind 'TAB:menu-complete'
bind 'set menu-complete-display-prefix on'
bind 'set completion-ignore-case On'

bind '"\e[A": history-search-backward'
bind '"\e[B": history-search-forward'
bind '"\e[C": forward-char'
bind '"\e[D": backward-char'

if [ -x /usr/bin/dircolors ]; then
    /usr/bin/test -r ~/.dircolors && eval "$(/usr/bin/dircolors -b ~/.dircolors)" || eval "$(/usr/bin/dircolors -b)"
fi

export LS_OPTIONS='--color=auto'

alias og='/usr/bin/ls $LS_OPTIONS -ogrt' 2>/dev/null
alias ls='/usr/bin/ls $LS_OPTIONS' 2>/dev/null
alias ll='/usr/bin/ls $LS_OPTIONS -l' 2>/dev/null
alias lld='/usr/bin/ls $LS_OPTIONS -ld' 2>/dev/null
alias lla='/usr/bin/ls $LS_OPTIONS -lA' 2>/dev/null
alias llh='/usr/bin/ls $LS_OPTIONS -lah --time-style=+%F\ %H:%M' 2>/dev/null
alias llt='/usr/bin/ls $LS_OPTIONS -lah --sort=time' 2>/dev/null
alias llr='/usr/bin/ls $LS_OPTIONS -lah --sort=time --revers' 2>/dev/null
alias la='/usr/bin/ls $LS_OPTIONS -A' 2>/dev/null
alias lt='/usr/bin/ls $LS_OPTIONS -ltr' 2>/dev/null
alias l='/usr/bin/ls $LS_OPTIONS -CF' 2>/dev/null
alias l.='/usr/bin/ls -d .* $LS_OPTIONS' 2>/dev/null
alias lsl='/usr/bin/ls -lhFA | less'
alias lsdate='/usr/bin/ls $LS_OPTIONS -l --time-style="+%d-%m-%Y"' 2>/dev/null

alias ffile='/usr/bin/find . -type f -name '
alias fhere='/usr/bin/find . -name '
alias psg='/usr/bin/ps aux | /usr/bin/grep -v grep | /usr/bin/grep -i -e VSZ -e'
alias mkdir='/usr/bin/mkdir -pv'
alias wget='/usr/bin/wget -c'
alias histg='history | /usr/bin/grep'
alias hostip='/usr/bin/curl http://ipecho.net/plain; echo'
alias net='/usr/bin/netstat -ntulp'
alias j='/usr/bin/jobs -l'
alias ports='/usr/bin/netstat -tulanp'

### Set default interfaces for sys admin related commands

## All of our servers eth1 is connected to the Internets via vlan / router etc  ##
alias dnstop='/usr/bin/dnstop -l 5 ens160'
alias vnstat='/usr/bin/vnstat -i ens160'
alias iftop='/usr/sbin/iftop -i ens160'
alias tcpdump='/usr/sbin/tcpdump -i ens160'
alias ethtool='/usr/sbin/ethtool ens160'

# work on wlan0 by default #
# Only useful for laptop as all servers are without wireless interface
alias iwconfig='/usr/bin/iwconfig wlan0'

### Get system memory, cpu usage, and gpu memory info quickly
## pass options to free ##
alias meminfo='/usr/bin/free -m -l -t'

## get top process eating memory
alias psmem='/usr/bin/ps auxf | /usr/bin/sort -nr -k 4'
alias psmem10='/usr/bin/ps auxf | /usr/bin/sort -nr -k 4 | head -10'

## get top process eating cpu ##
alias pscpu='/usr/bin/ps auxf | /usr/bin/sort -nr -k 3'
alias pscpu10='/usr/bin/ps auxf | /usr/bin/sort -nr -k 3 | head -10'

#  15 процессов, которые больше всего потребляют памяти
alias top15='/usr/bin/top -b -o +%MEM | /usr/bin/head -n 22'

## Get server cpu info ##
alias cpuinfo='/usr/bin/lscpu'

## older system use /proc/cpuinfo ##
##alias cpuinfo='less /proc/cpuinfo' ##

## get GPU ram on desktop / laptop##
alias gpumeminfo='/usr/bin/grep -i --color memory /var/log/Xorg.0.log'

alias grep='/usr/bin/grep --color=auto'
alias fgrep='/usr/bin/grep --color=auto'
alias egrep='/usr/bin/grep --color=auto'

alias h='history 10'
#alias mc='. /usr/libexec/mc/mc-wrapper.sh'

alias myip="/usr/bin/ip a | /usr/bin/grep inet | /usr/bin/grep 'scope global'"

if type vim &>/dev/null; then
	alias vi=/usr/bin/vim
fi

if type colordiff &>/dev/null ; then
    alias diff='/usr/bin/colordiff'
fi

if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
  fi
fi


myprompt() {
    history -a ; history -c ; history -r
    if [ "$CLICOLOR" == "1" ]; then
        #echo -e "\033[00m[\033[01;32m$(uptime | awk -F 'age:' '{ print $2 }')\033[00m][\033[01;32m$(who | wc -l)\033[00m][\033[01;32m$(jobs | wc -l)\033[00m]"
        if [ "$(id -u)" == "0" ]; then
            PS1='\[\e[m\][\[\e[1;31m\]\u@\h\[\e[m\] \[\e[0;33m\]$(pwd)\[\e[m\]]\[\e[1;31m\]\$\[\e[m\] '
        else
            PS1='\[\e[m\][\[\e[1;32m\]\u@\h\[\e[m\] \[\e[0;33m\]$(pwd)\[\e[m\]]\[\e[1;32m\]\$\[\e[m\] '
        fi
    else
        #echo "[$(uptime | cut -d: -f5)][$(who | wc -l)][$(jobs | wc -l)]"
        PS1='\[\e[m\][\u@\h \w]\$ '
    fi
}


PROMPT_COMMAND=myprompt
export PROMPT_COMMAND

COWSAY=`/usr/bin/which cowsay 2>/dev/null`
FORTUNE=`/usr/bin/which fortune 2>/dev/null`

if [ -n "$COWSAY" ]; then
    if [ -n "$FORTUNE" ]; then
        $FORTUNE | $COWSAY
    else
        echo "Hi, people! Today is $(/usr/bin/date +'%A %d %B %Y')" | $COWSAY
    fi
fi
